var Actor=function(a,c,b,d,f){this.startAnimationTimestamp=(new Date).getTime();this.resetStartAnimationTimestamp=function(){this.startAnimationTimestamp=(new Date).getTime()};this.startPosition={x:c,y:b};this.vector={x:0,y:0};this.spin=this.tilt=0;this.behaviors=[];this.phases=[];this.oldPhase=0;this.phaseCycle=1E3;this.enteredAt=null;this.waitingForReset=this.doesReset=!1;this.waitingForResetSince=null;this.currentOpacity=1;this.delay=this.originaldelay=0;this.navigatesOnTouch=function(a,b){this.reacts("window.animation.showScene('"+
a+"')",b);this.image.className+="navigation";this.scene.preloadSceneIds.push(a)};this.delays=function(a){this.delay=this.originaldelay=a};this.age=function(){return(new Date).getTime()-this.startAnimationTimestamp};this.setOpacity=function(a){a!=this.currentOpacity&&(this.currentOpacity=a,this.image.style.opacity=this.currentOpacity)};this.resets=function(a){this.doesReset=!0;"undefined"===typeof a&&(a=0);this.resetDelay=a};this.reset=function(){for(var a=0;a<this.behaviors.length;a++)try{this.behaviors[a].ontouch?
delete this.behaviors[a]:this.behaviors[a].reset()}catch(h){}this.image.src="images/"+this.image.originalPath;this.resetStartAnimationTimestamp();this.position={x:c,y:b};this.vector={x:0,y:0};this.setSize(d,f);this.setOpacity(1);this.delay=this.originaldelay;this.finishedDelaying=!1;this.startedDelayingAt=null;this.tilt=0;moveActor(this);tiltActor(this)};this.setSize=function(a,b){this.imagesize={x:a,y:b};this.image.style.width=a+"px";this.image.style.height=b+"px"};this.enter=function(a){a.div.appendChild(this.image);
this.enteredAt=(new Date).getTime()};this.addBehavior=function(a){try{a.reset()}catch(b){}this.behaviors.push(a)};"undefined"!=typeof delay&&(this.delay=parseInt(delay),this.startedDelayingAt=null,this.finishedDelaying=!1);this.addPhase=function(a){document.createElement("img").setAttribute("src","images/"+a);this.phases.push("images/"+a)};this.setPhaseCycleLength=function(a){this.phaseCycle=a};this.currentPhase=function(){var a=0,b=this.phases.length;if(1<b)var a=(new Date).getTime()-this.enteredAt,
c=this.phaseCycle/b,a=parseInt(a%(b*c)/c);return a};this.setup=function(){this.image=document.createElement("img");this.image.originalPath=a;this.image.setAttribute("src","images/"+this.image.originalPath);this.image.actor=this;this.phases.push("images/"+a);this.position={x:c,y:b};this.setSize(d,f);this.vector={x:0,y:0};moveActor(this)};this.setup()};
function moveActor(a){a.position.x+=a.vector.x;a.position.y+=a.vector.y;a.image.style.left=a.position.x+"px";a.image.style.top=a.position.y+"px";a.vector={x:0,y:0}}function tiltActor(a){a.tilt=(a.tilt+a.spin)%360;a.image.style.transform="rotate("+a.tilt+"deg)";a.image.style.webkitTransform="rotate("+a.tilt+"deg)";a.image.style.msTransform="rotate("+a.tilt+"deg)";a.image.style.OTransform="rotate("+a.tilt+"deg)";a.spin=0}function visibleOnStage(){return!notVisibleOnStage}
function notVisibleOnStage(a){return a.position.x>a.scene.dimensions.x||0>a.position.x+a.imagesize.x||0>a.position.y+a.imagesize.y||a.position.y>a.scene.dimensions.y}
function animateactor(a){if(notVisibleOnStage(a))a.waitingForReset?t()-a.waitingForResetSince>=a.resetDelay&&(a.reset(),a.waitingForReset=!1):a.doesReset&&(a.setOpacity(0),a.waitingForReset=!0,a.waitingForResetSince=t());else if(0<a.delay&&!a.finishedDelaying)null==a.startedDelayingAt?a.startedDelayingAt=t():t()>=a.startedDelayingAt+a.delay&&(a.finishedDelaying=!0);else{1<a.phases.length&&a.currentPhase()!=a.oldPhase&&(a.image.src=a.phases[a.currentPhase()],a.oldPhase=a.currentPhase());for(var c=
0;c<a.behaviors.length;c++)a.behaviors[c].applybehavior();(0!=a.vector.x||0!=a.vector.y)&&moveActor(a);0!=a.spin&&tiltActor(a)}};function Animation(a,c,b,d,f,g){this.loadedScenes=[];this.stageDiv=createDiv("stage","stage");this.stageDiv.style.width=a+"px";this.stageDiv.style.height=c+"px";this.width=a;this.height=c;this.minWidth=b;this.maxWidth=d;this.minHeight=f;this.maxHeight=g;this.scaleToWindow=function(){var a=window.innerWidth,b=window.innerHeight,c=b,d=a,f=window.innerWidth/window.innerHeight,g=this.width/this.height;if(0!=this.minWidth&&g>f){a<this.minWidth?a=this.minWidth:a>this.maxWidth&&(a=this.maxWidth);var i=a/
this.width,c=a*i}else 0!=this.minWidth&&(b<this.minHeight?b=this.minHeight:b>this.maxHeight&&(b=this.maxHeight),i=b/this.height,d=b*i);1!=i&&rescale(this.stageDiv,i);window.animationwrapper.style.marginTop=(window.innerHeight-parseInt(this.height*i))/2+"px";window.animationwrapper.style.width=d+"px";window.animationwrapper.style.marginLeft=(window.innerWidth-parseInt(this.width*i))/2+"px";window.animationwrapper.style.height=c+"px"};this.loadScene=function(b){for(var d=this.loadedScenes.length-1;0<=
d;d--)if(this.loadedScenes[d].id.match(b))return this.loadedScenes[d];b=eval(b+"()");b.setDimensions(a,c);this.loadedScenes.push(b);this.stageDiv.appendChild(b.div);b.makeInvisible();return b};this.showScene=function(a){this.currentScene=loadScene(a);a=getIntegerFromEndOfString(a);window.location.hash=0==a?"":a;this.currentScene.enterActors();this.currentScene.resetActors();this.currentScene.makeOthersInvisible();this.currentScene.muteOthers();this.dropUnneededScenes(this.currentScene.preloadSceneIds);
this.loadNeededScenes(this.currentScene.preloadSceneIds)};this.loadedSceneIds=function(){for(var a=[],b=this.loadedScenes.length-1;0<=b;b--)a.push(this.loadedScenes[b].id);return a};this.dropUnneededScenes=function(a){for(var a=this.loadedSceneIds().minus(a),b=a.length-1;0<=b;b--)this.dropScene(a[b])};this.loadNeededScenes=function(a){for(var a=a.minus(this.loadedSceneIds()),b=a.length-1;0<=b;b--)this.loadScene(a[b])};this.dropScene=function(a){for(var b=this.loadedScenes.length-1;0<=b;b--)this.loadedScenes[b].id.match(a)&&
(document.getElementById(a),this.stageDiv.removeChild(this.loadedScenes[b].div),this.loadedScenes=this.loadedScenes.without(b))};return this}
function loadAnimation(a,c,b,d,f,g,h,e){document.title=a;if(browserCompatible()){if(window.onload)var j=window.onload;window.onload=function(){j&&j();setTimeout(function(){window.scrollTo(0,1)},100);window.animation=Animation(c,b,f,g,h,e);window.animationwrapper=createDiv("animationwrapper","");window.document.body.appendChild(window.animationwrapper);window.animation.scaleToWindow();window.animationwrapper.appendChild(this.stageDiv);var a=parseInt(window.location.hash.substring(1));isNaN(a)?window.animation.showScene(d):
eval("window.animation.showScene('scene"+a+"')");window.animation.startLoop()};if(window.onresize)var k=window.onresize;window.onresize=function(){k&&k();window.animation.scaleToWindow()}}else a=document.createElement("div"),a.setAttribute("id","compatibility"),a.innerHTML+="<h1>Please upgrade your browser</h1>",a.innerHTML+="<p>You need a more modern browser to view this awesome animation.</p>",a.innerHTML+='<p>More information: <a href="http://animation.io/compatible-browsers.html">http://animation.io/compatible-browsers.html</a></p>',
document.body.appendChild(a)}requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();function startLoop(){this.animloop=function(){requestAnimFrame(animloop);for(var a=0;a<window.currentScene.actors.length;a++)animateactor(window.currentScene.actors[a])};this.animloop()};Array.prototype.minus=function(a){for(var c=this,b=c.length-1;0<=b;b--)for(var d=a.length-1;0<=d;d--)if(a[d].match(c[b])){c=c.without(b);break}return c};Array.prototype.without=function(a){var c=0<a?this.slice(0,a):[],a=this.slice(a+1);return c.concat(a)};function bindEvent(a,c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent&&a.attachEvent("on"+c,b)};function l(a){console.log(a)}function round(a,c){0>c&&(c=0);this.q=Math.pow(10,c);return Math.round(a*this.q)/this.q}function cutOffPx(a){return parseFloat(a.toString().substring(0,a.length-2))}function createDiv(a,c){var b=document.createElement("div");b.setAttribute("id",a);b.setAttribute("class",c);return b}function t(){return(new Date).getTime()}function browserCompatible(){try{return new Audio,!0}catch(a){return!1}}function getIntegerFromEndOfString(a){return parseInt(a.match(/\d+$/)[0])}
function rescale(a,c){a.style.transformOrigin="0 0";a.style.transform="scale("+c+", "+c+")";a.style.msTransformOrigin="0 0";a.style.msTransform="scale("+c+", "+c+")";a.style.webkitTransformOrigin="0 0";a.style.webkitTransform="scale("+c+", "+c+")";a.style.OTransformOrigin="0 0";a.style.OTransform="scale("+c+", "+c+")"};function Plugin(a,c){this.delay=a;this.easeIn="undefined"!=typeof c?c:0;this.needsToCalculateEasein=0<this.easeIn;this.startAnimationTimestamp=(new Date).getTime();this.resetStartAnimationTimestamp=function(){this.startAnimationTimestamp=(new Date).getTime()};this.applybehavior=function(){};this.resetPlugin=function(){this.resetStartAnimationTimestamp();this.needsToCalculateEasein=0<this.easeIn};this.age=function(){return(new Date).getTime()-this.startAnimationTimestamp};this.factor=function(){if(this.needsToCalculateEasein&&
0<this.easeIn&&this.age()<this.easeIn)return Math.cos(this.age()/this.easeIn*(Math.PI/2)-Math.PI/2);this.needsToCalculateEasein=!1;return 1};return this};function Scene(a,c){this.id=a;this.title="undefined"!=typeof c?c:a;this.div=createDiv(a,"scene");this.stage=null;this.dimensions={x:0,y:0};this.isVisible=!1;this.actors=[];this.preloadSceneIds=[a];this.resetActors=function(){for(var a=this.actors.length-1;0<=a;a--)this.actors[a].reset()};this.setDimensions=function(a,c){this.dimensions={x:a,y:c};this.div.style.width=this.dimensions.x+"px";this.div.style.height=this.dimensions.y+"px"};this.makeVisible=function(){this.div.style.visibility="visible";
this.isVisible=!0};this.makeInvisible=function(){this.div.style.visibility="hidden";this.isInvisible=!1;this.resetActors()};this.makeInvisible();this.makeOthersInvisible=function(){for(var a=window.animation.loadedScenes.length-1;0<=a;a--)window.animation.loadedScenes[a].id.match(this.id)?this.makeVisible():window.animation.loadedScenes[a].makeInvisible()};this.mute=function(){for(var a=0;a<this.actors.length;a++)try{this.actors[a].pauseAudio()}catch(c){}};this.muteOthers=function(){for(var a=window.animation.loadedScenes.length-
1;0<=a;a--)window.animation.loadedScenes[a].id.match(this.id)||window.animation.loadedScenes[a].mute()};this.createActor=function(a,c,f,g,h){a=new Actor(a,c,f,g,h);a.scene=this;this.actors.push(a);return a};this.enterActors=function(){for(var a=0;a<this.actors.length;a++)this.actors[a].enter(this)};this.putOnStage=function(a){a.appendChild(this.div);a.scene=this;this.stage=a;this.dimensions={x:parseInt(a.style.width),y:parseInt(a.style.height)};this.div.style.width=this.dimensions.x+"px";this.div.style.height=
this.dimensions.y+"px";for(a=0;a<window.stage.scene.actors.length;a++)this.actors[a].enter(this)};this.write=function(a,c,f,g){var h=document.createElement("div");h.innerHTML=f;h.setAttribute("class","text "+("undefined"===typeof g?"":g));h.style.left=a+"px";h.style.top=c+"px";this.div.appendChild(h)};return this};function Dissolving(a,c,b){this.actor=a;var d=this.actor.currentOpacity,f;this.reset=function(){this.actor.setOpacity(d);this.dissolveStartedAt=(new Date).getTime()};this.applybehavior=function(){0<this.actor.currentOpacity&&this.actor.age()>c&&("undefined"===typeof this.dissolveStartedAt&&(this.dissolveStartedAt=(new Date).getTime()),f=1+(this.dissolveStartedAt-(new Date).getTime())/b,this.actor.setOpacity(f))}}Actor.prototype.dissolves=function(a,c){this.addBehavior(new Dissolving(this,a,c))};
Actor.prototype.dissolvesOnTouch=function(a){this.reacts("this.actor.dissolves(new Date().getTime() - this.actor.startAnimationTimestamp,"+a+");")};function Drifting(a,c,b){this.reset=function(){this.force={x:c,y:b}};this.reset();this.applybehavior=function(){a.vector.x+=this.force.x;a.vector.y+=this.force.y}}Actor.prototype.drifts=function(a,c){this.addBehavior(new Drifting(this,a,c))};function Linking(a,c){this.actor=a;this.url=c;/iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)?bindEvent(this.actor.image,"touchstart",function(){this.gotourl()}):bindEvent(this.actor.image,"mousedown",function(){this.gotourl()});this.actor.image.gotourl=function(){this.removeEventListener("mousedown",arguments.callee,!1);location.href=c};this.actor.image.style.cursor="pointer";this.applybehavior=function(){}}Actor.prototype.links=function(a){this.addBehavior(new Linking(this,a))};function Moving(a,c,b,d,f,g,h){var e=new Plugin(g,h);e.actor=a;e.force={x:c,y:b};e.speed={x:0,y:0};e.friction=d;e.gravitation=f;e.triggeredByTouch=!1;e.reset=function(){this.resetPlugin();e.speed={x:0,y:0};e.force={x:c,y:b}};e.reset();e.applybehavior=function(){1!=this.factor()&&(console.log("this.factor(): "+this.factor()),console.log("this.age(): "+this.age()));e.force.x*=0.9;e.force.y*=0.9;"undefined"!=typeof e.gravitation&&(e.force.y+=e.gravitation/50);e.speed.x+=e.force.x;e.speed.y+=e.force.y;
"undefined"!=typeof e.friction&&(e.speed.x*=1-e.friction/50,e.speed.y*=1-e.friction/50);e.actor.vector.x+=e.speed.x*this.factor();e.actor.vector.y+=e.speed.y*this.factor()};return e}Actor.prototype.moves=function(a,c,b,d,f,g){this.addBehavior(new Moving(this,a,c,b,d,f,g))};
Actor.prototype.movesOnTouch=function(a,c,b,d,f,g){a=a+","+c;"undefined"!=typeof b&&(a+=", "+b);"undefined"!=typeof d&&(a+=", "+d);"undefined"!=typeof f&&(a+=", "+f);"undefined"!=typeof g&&(a+=", "+g);this.reacts("this.actor.moves("+a+");")};function Playing(a,c,b){var d=new Plugin(0,0);d.actor=a;d.actor.playingImagePath="images/"+b;d.actor.waitingImagePath=d.actor.image.src;d.actor.showPlayingImage=function(){this.image.src=this.playingImagePath};d.actor.showWaitingImage=function(){this.image.src=this.waitingImagePath};d.actor.audio=document.createElement("audio");b=document.createElement("source");b.type=d.actor.audio.canPlayType("audio/mpeg;")?"audio/mpeg":"audio/ogg";b.src="audio/"+c+".mp3";d.actor.audio.appendChild(b);d.actor.audio.actor=
d.actor;d.actor.audio.load();bindEvent(d.actor.audio,"ended",function(){this.actor.showWaitingImage(this.actor);this.actor.audioplaying=!1});d.actor.audioplaying=!1;d.actor.toggleAudio=function(){this.audioplaying?(this.audio.pause(),this.audioplaying=!1,this.showWaitingImage()):(this.audio.currentTime&&(this.audio.currentTime=0),this.audio.play(),this.showPlayingImage(),this.audioplaying=!0)};d.actor.pauseAudio=function(){this.audio.pause()};d.actor.addBehavior(new Reacting(a,"this.actor.toggleAudio();"));
return d}Actor.prototype.plays=function(a,c){this.addBehavior(new Playing(this,a,c))};function Pulsating(a,c,b){this.applybehavior=function(){var d=1+b/20*Math.sin(2*new Date*c/500);a.image.style.webkitTransform="scale("+d+", "+d+")"}}Actor.prototype.pulsates=function(a,c){this.addBehavior(new Pulsating(this,a,c))};function Reacting(a,c,b){var d=new Plugin(0,0);d.actor=a;d.actor.action=c;"undefined"!=typeof b&&(b="images/"+b,document.createElement("img").setAttribute("src",b),d.actor.image.actionimagepath=b);a=/iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)?"touchstart":"mousedown";bindEvent(d.actor.image,a,function(){changeImageAndReact.call(d.actor.image)});d.actor.image.style.cursor="pointer";return d}
function changeImageAndReact(){if("undefined"!=typeof this.actionimagepath&&(this.originalimagepath=this.src,this.src=this.actionimagepath,"undefined"!=typeof actionimagelength&&0<parseInt("0"+actionimagelength))){var a=this;window.setTimeout(function(){parseInt(a.src=a.originalimagepath)},200)}eval(this.actor.action)}Actor.prototype.reacts=function(a,c,b){this.addBehavior(new Reacting(this,a,c,b))};function Rotating(a,c){this.spin=6*c;this.applybehavior=function(){a.spin+=this.spin}}Actor.prototype.rotates=function(a,c){var b=new Rotating(this,a);c&&(b.ontouch=!0);this.addBehavior(b)};Actor.prototype.rotatesOnTouch=function(a){this.reacts("this.actor.rotates("+a+", true);")};function Shaking(a,c,b,d){this.reset=function(){this.peak={x:c/2,y:b/2};this.hertz=d;this.actor=a;this.force={x:0,y:0}};this.reset();this.applybehavior=function(){"undefined"===typeof this.shakingStartedAt&&(this.shakingStartedAt=(new Date).getTime());this.tmpValue=Math.sin((this.shakingStartedAt-(new Date).getTime())*this.hertz/250);"undefined"!=typeof this.lastTmpValue&&(this.actor.vector.x+=(this.lastTmpValue-this.tmpValue)*this.peak.x,this.actor.vector.y+=(this.lastTmpValue-this.tmpValue)*this.peak.y);
this.lastTmpValue=this.tmpValue}}Actor.prototype.shakes=function(a,c,b){this.addBehavior(new Shaking(this,a,c,b))};Actor.prototype.shakesOnTouch=function(a,c,b){this.reacts("this.actor.shakes("+a+","+c+","+b+");")};function Swinging(a,c,b,d,f){var g=0;this.applybehavior=function(){g=Math.sin(new Date*b/1E3);degrees=g*c;a.image.style.webkitTransformOrigin=d+"px "+f+"px";a.image.style.webkitTransform="rotate("+degrees/2+"deg)"}}Actor.prototype.swings=function(a,c,b,d){this.addBehavior(new Swinging(this,a,c,b,d))};function Waving(a,c,b,d,f){this.reset=function(){this.actor=a;this.hertz=b;this.radius=c};this.applybehavior=function(){"undefined"===typeof this.wavingStartedAt&&(this.wavingStartedAt=(new Date).getTime());this.skew=Math.sin((this.wavingStartedAt-(new Date).getTime())*this.hertz/1E3)*this.radius;this.actor.image.style.webkitTransformOrigin=d+"px "+f+"px";this.actor.image.style.webkitTransform="skew("+this.skew+"deg, 0deg)";this.actor.image.style.transformOrigin=d+"px "+f+"px";this.actor.image.style.transform=
"skew("+this.skew+"deg, 0deg)";this.actor.image.style.msTransformOrigin=d+"px "+f+"px";this.actor.image.style.msTransform="skew("+this.skew+"deg, 0deg)";this.actor.image.style.OTransformOrigin=d+"px "+f+"px";this.actor.image.style.OTransform="skew("+this.skew+"deg, 0deg)"}}Actor.prototype.waves=function(a,c,b,d){this.addBehavior(new Waving(this,a,c,b,d))};
